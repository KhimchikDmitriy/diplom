<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <br />
<a class="btn btn-success" href="/"> На главную страницу</a>
<br />
<% if (role === "admin") { %>
  <form action="/table" method="post">
    <select name="select">
      <% entries.chat.forEach(function(entry) { %>
      <option value="<%= entry.name %>"><%= entry.name %></option>
      <% }) %>
    </select>
    <input class="btn btn-success" type="submit" value="Выберите получателя" />
  </form>
  <% } %>
  <br>
<% entries.posts.forEach(function(entry) { %>
  <br />
  <% if (entry.whom === user.name || entry.whom === user.name.familyName + " " + user.name.givenName || role === "admin" && entry.whom === select) { %>
    <% if (entry.title === "message") { %>
      <div class="message">
        <p class="delete-link">
          <a href="posts/delete/<%= entry.id %>"><i class="fa-solid fa-trash-can"></i></a>
        </p>
        <p class="message-body"><p> <%= entry.author %></p><%= entry.body %></p>
        <% if (entry.media) { %>
          <img src="../uploads/<%= entry.media %>" class="message-image" />
          <a href="../uploads/<%= entry.media %>" download>Скачать файл</a>
          <% } %>
        </div>
        <br />
        <% } %>
        <% } %>
        <% }); %>
    <form action="/upload/message" method="post" enctype="multipart/form-data">
        <input type="text" name="body" id="body" placeholder="Введите сообщение..." />
        <button type="submit">Отправить</button>
        <div class="mb-3">
          <input
            class="form-control"
            type="file"
            id="media"
            name="media"
          />
        </div>
        
    </form>
</body>

  <style>
    form {
      width: 400px;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      background: #f7f7f7;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 3px;
      outline: none;
      box-sizing: border-box;
    }

    button[type="submit"] {
      width: 100%;
      padding: 10px 20px;
      font-size: 16px;
      color: white;
      background-color: #3498db;
      border: none;
      cursor: pointer;
      border-radius: 3px;
      transition: background-color 0.3s;
    }

    button[type="submit"]:hover {
      background-color: #2980b9;
    }

    input[type="file"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 3px;
      outline: none;
      box-sizing: border-box;
    }

    .message {
      width: 100%;
      margin-bottom: 20px;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      background: #f7f7f7;
    }

    .message .delete-link {
      float: right;
    }

    .message .message-body {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 16px;
      line-height: 1.5;
    }

    .message img.message-image {
      max-width: 100%;
      height: auto;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</html>
